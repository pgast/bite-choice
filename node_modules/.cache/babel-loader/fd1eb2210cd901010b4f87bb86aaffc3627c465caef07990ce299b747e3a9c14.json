{"ast":null,"code":"import _toConsumableArray from\"/Users/pablogl/Documents/Dev/bite-choice/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"/Users/pablogl/Documents/Dev/bite-choice/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/pablogl/Documents/Dev/bite-choice/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/pablogl/Documents/Dev/bite-choice/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import'./style.css';import ListItem from'../ListItem';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ChoiceView=/*#__PURE__*/React.lazy(function(){return import('../ChoiceView');});var ErrorScreen=/*#__PURE__*/React.lazy(function(){return import('../ErrorScreen');});var ResultList=function ResultList(_ref){var data=_ref.data,randomSorting=_ref.randomSorting,isCustom=_ref.isCustom,toggleUi=_ref.toggleUi,customSearchTerms=_ref.customSearchTerms;var _useState=useState([{name:'Fetching',categories:[{title:''}]}]),_useState2=_slicedToArray(_useState,2),displayItems=_useState2[0],setDisplayItems=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),businesses=_useState4[0],setBusinesses=_useState4[1];useEffect(function(){if(isCustom){setStatesCustom(data);}else{setStatesFromArray(data);}},[data,setBusinesses]);var getIndeces=function getIndeces(businesses){var indeces=[];if(businesses.length<=3){indeces.push(0,2);}else if(businesses.length!==0){while(indeces.length<3){var number=Math.floor(Math.random()*Math.floor(businesses.length));if(!indeces.includes(number)){indeces.push(number);}};}return indeces;};var randomPicks=function randomPicks(array){var results=getIndeces(array).map(function(el){return array[el];});return results;};var setStatesCustom=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(inputData){var data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return inputData;case 2:data=_context.sent;if(customSearchTerms.searchTerms.length===0){setStatesFromArray(data);}else if(customSearchTerms.searchTerms.length===1){setStatesFromArray(data[0]);}else{setStatesFromTerms(data);}case 4:case\"end\":return _context.stop();}},_callee);}));return function setStatesCustom(_x){return _ref2.apply(this,arguments);};}();var setStatesFromTerms=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(inputData){var newData,newDisplayItems,allResults,emptyArrays,j;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return inputData;case 2:newData=_context2.sent;newDisplayItems=[];if(!randomSorting){_context2.next=10;break;}allResults=[];newData.forEach(function(item){allResults=[].concat(_toConsumableArray(allResults),_toConsumableArray(item));});setStatesFromArray(allResults);_context2.next=26;break;case 10:if(!(newDisplayItems.length<3)){_context2.next=24;break;}emptyArrays=newData.every(function(item){return item.length===0;});if(!emptyArrays){_context2.next=14;break;}return _context2.abrupt(\"break\",24);case 14:j=0;case 15:if(!(j<newData.length)){_context2.next=22;break;}if(newData[j].length!==0){newDisplayItems.push(newData[j].shift());}if(!(newDisplayItems.length===3)){_context2.next=19;break;}return _context2.abrupt(\"break\",22);case 19:j++;_context2.next=15;break;case 22:_context2.next=10;break;case 24:setBusinesses(newData);setDisplayItems(newDisplayItems);case 26:case\"end\":return _context2.stop();}},_callee2);}));return function setStatesFromTerms(_x2){return _ref3.apply(this,arguments);};}();var setStatesFromArray=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(inputData){var newData,newDisplayItems,i,item;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.next=2;return inputData;case 2:newData=_context3.sent;newDisplayItems=[];if(newData===500){newDisplayItems=[{name:500,categories:[{title:''}]}];}if(newData==\"error\"||newData===undefined){newDisplayItems=[{name:\"Error\",categories:[{title:''}]}];}else if(newData.length<3&&newData.length!==0){newDisplayItems=newData;}else if(newData.length>3){if(randomSorting){newDisplayItems=randomPicks(newData);}else{newDisplayItems=[newData[0],newData[1],newData[2]];}for(i=0;i<newDisplayItems.length;i++){item=newData.indexOf(newDisplayItems[i]);if(item>-1){newData.splice(item,1);};}}setBusinesses(newData);setDisplayItems(newDisplayItems);case 8:case\"end\":return _context3.stop();}},_callee3);}));return function setStatesFromArray(_x3){return _ref4.apply(this,arguments);};}();var _removeItem=function removeItem(passedIndex){var newDisplayItems=displayItems.filter(function(el,index){return passedIndex!==index;});var newState=businesses;var newItem;if(randomSorting){newItem=newState[getIndeces(newState)[0]];newState=newState.filter(function(el){return newItem.name!==el.name;});}else{if(customSearchTerms.searchTerms.length>1){var newEntry=undefined;while(newEntry===undefined){var emptyArrays=newState.every(function(item){return item.length===0;});if(emptyArrays)break;var pickedArray=Math.floor(Math.random()*Math.floor(newState.length));if(newState[pickedArray].length!==0){newEntry=newState[pickedArray].shift();};}newItem=newEntry;}else{newItem=newState.shift();}}if(newItem!==undefined){newDisplayItems.push(newItem);};setBusinesses(newState);setDisplayItems(newDisplayItems);};return/*#__PURE__*/_jsxs(\"div\",{className:isCustom?\"resultList resultList--custom\":\"resultList\",children:[displayItems.length>1&&/*#__PURE__*/_jsx(_Fragment,{children:displayItems.map(function(el,index){return/*#__PURE__*/_jsx(ListItem,{item:el,removeItem:function removeItem(){return _removeItem(index);}},index);})}),displayItems.length<1&&/*#__PURE__*/_jsxs(\"div\",{className:\"resultList__fetching\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-utensils\"}),/*#__PURE__*/_jsx(\"h1\",{children:\"Fetching places...\"})]}),displayItems.length===1&&(displayItems[0].name===\"Error\"||displayItems[0].name===500)&&/*#__PURE__*/_jsx(ErrorScreen,{error:displayItems[0].name}),displayItems.length===1&&displayItems[0].name!==\"Error\"&&displayItems[0].name!==\"Fetching\"&&displayItems[0].name!==500&&/*#__PURE__*/_jsx(ChoiceView,{item:displayItems[0],toggleUi:toggleUi})]});};export default ResultList;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}