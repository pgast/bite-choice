{"ast":null,"code":"import _toConsumableArray from \"/Users/Pablo/Documents/React/bitechoice/biteFinal/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"/Users/Pablo/Documents/React/bitechoice/biteFinal/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/Pablo/Documents/React/bitechoice/biteFinal/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/Pablo/Documents/React/bitechoice/biteFinal/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/Pablo/Documents/React/bitechoice/biteFinal/client/src/components/Results/ResultList.js\";\n\nimport React, { useState, useEffect } from 'react';\nimport './style.css';\nimport ListItem from '../ListItem';\nvar ChoiceView = React.lazy(function () {\n  return import('../ChoiceView');\n});\nvar ErrorScreen = React.lazy(function () {\n  return import('../ErrorScreen');\n}); // TODO: result list\n\nfunction getIndeces(businesses) {\n  var indeces = [];\n\n  if (businesses.length <= 3) {\n    indeces.push(0, 2);\n  } else if (businesses.length !== 0) {\n    while (indeces.length < 3) {\n      var number = Math.floor(Math.random() * Math.floor(businesses.length));\n      if (!indeces.includes(number)) indeces.push(number);\n    }\n\n    ;\n  }\n\n  return indeces;\n}\n\nfunction randomPicks(array) {\n  var results = getIndeces(array).map(function (el) {\n    return array[el];\n  });\n  return results;\n}\n\nvar resultList = function resultList(_ref) {\n  var data = _ref.data,\n      randomSorting = _ref.randomSorting,\n      isCustom = _ref.isCustom,\n      toggleUi = _ref.toggleUi,\n      customSearchTerms = _ref.customSearchTerms;\n\n  var _useState = useState([{\n    name: 'Fetching',\n    categories: [{\n      title: ''\n    }]\n  }]),\n      _useState2 = _slicedToArray(_useState, 2),\n      displayItems = _useState2[0],\n      setDisplayItems = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      businesses = _useState4[0],\n      setBusinesses = _useState4[1];\n\n  useEffect(function () {\n    if (isCustom) {\n      setStatesCustom(data);\n    } else {\n      setStatesFromArray(data);\n    }\n  }, [data, setBusinesses]);\n\n  var setStatesCustom = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(inputData) {\n      var data;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return inputData;\n\n            case 2:\n              data = _context.sent;\n\n              if (customSearchTerms.searchTerms.length === 0) {\n                setStatesFromArray(data);\n              } else if (customSearchTerms.searchTerms.length === 1) {\n                setStatesFromArray(data[0]);\n              } else {\n                setStatesFromTerms(data);\n              }\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function setStatesCustom(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var setStatesFromTerms = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(inputData) {\n      var newData, newDisplayItems, allResults, emptyArrays, j;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return inputData;\n\n            case 2:\n              newData = _context2.sent;\n              newDisplayItems = [];\n\n              if (!randomSorting) {\n                _context2.next = 10;\n                break;\n              }\n\n              allResults = [];\n              newData.forEach(function (item) {\n                allResults = [].concat(_toConsumableArray(allResults), _toConsumableArray(item));\n              });\n              setStatesFromArray(allResults);\n              _context2.next = 26;\n              break;\n\n            case 10:\n              if (!(newDisplayItems.length < 3)) {\n                _context2.next = 24;\n                break;\n              }\n\n              emptyArrays = newData.every(function (item) {\n                return item.length === 0;\n              });\n\n              if (!emptyArrays) {\n                _context2.next = 14;\n                break;\n              }\n\n              return _context2.abrupt(\"break\", 24);\n\n            case 14:\n              j = 0;\n\n            case 15:\n              if (!(j < newData.length)) {\n                _context2.next = 22;\n                break;\n              }\n\n              if (newData[j].length !== 0) {\n                newDisplayItems.push(newData[j].shift());\n              }\n\n              if (!(newDisplayItems.length === 3)) {\n                _context2.next = 19;\n                break;\n              }\n\n              return _context2.abrupt(\"break\", 22);\n\n            case 19:\n              j++;\n              _context2.next = 15;\n              break;\n\n            case 22:\n              _context2.next = 10;\n              break;\n\n            case 24:\n              setBusinesses(newData);\n              setDisplayItems(newDisplayItems);\n\n            case 26:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function setStatesFromTerms(_x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var setStatesFromArray = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(inputData) {\n      var newData, newDisplayItems, i, item;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return inputData;\n\n            case 2:\n              newData = _context3.sent;\n              newDisplayItems = [];\n\n              if (newData === 500) {\n                newDisplayItems = [{\n                  name: 500,\n                  categories: [{\n                    title: ''\n                  }]\n                }];\n              }\n\n              if (newData == \"error\" || newData === undefined) {\n                newDisplayItems = [{\n                  name: \"Error\",\n                  categories: [{\n                    title: ''\n                  }]\n                }];\n              } else if (newData.length < 3 && newData.length !== 0) {\n                newDisplayItems = newData;\n              } else if (newData.length > 3) {\n                if (randomSorting) {\n                  newDisplayItems = randomPicks(newData);\n                } else {\n                  newDisplayItems = [newData[0], newData[1], newData[2]];\n                }\n\n                for (i = 0; i < newDisplayItems.length; i++) {\n                  item = newData.indexOf(newDisplayItems[i]);\n\n                  if (item > -1) {\n                    newData.splice(item, 1);\n                  }\n\n                  ;\n                }\n              }\n\n              setBusinesses(newData);\n              setDisplayItems(newDisplayItems);\n\n            case 8:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function setStatesFromArray(_x3) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var _removeItem = function removeItem(passedIndex) {\n    var newDisplayItems = displayItems.filter(function (el, index) {\n      return passedIndex !== index;\n    });\n    var newState = businesses;\n    var newItem;\n\n    if (randomSorting) {\n      newItem = newState[getIndeces(newState)[0]];\n      newState = newState.filter(function (el) {\n        return newItem.name !== el.name;\n      });\n    } else {\n      if (customSearchTerms.searchTerms.length > 1) {\n        var newEntry = undefined;\n\n        while (newEntry === undefined) {\n          var emptyArrays = newState.every(function (item) {\n            return item.length === 0;\n          });\n          if (emptyArrays) break;\n          var pickedArray = Math.floor(Math.random() * Math.floor(newState.length));\n\n          if (newState[pickedArray].length !== 0) {\n            newEntry = newState[pickedArray].shift();\n          }\n\n          ;\n        }\n\n        newItem = newEntry;\n      } else {\n        newItem = newState.shift();\n      }\n    }\n\n    if (newItem !== undefined) {\n      newDisplayItems.push(newItem);\n    }\n\n    ;\n    setBusinesses(newState);\n    setDisplayItems(newDisplayItems);\n  };\n\n  return React.createElement(\"div\", {\n    className: isCustom ? \"resultList resultList--custom\" : \"resultList\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 5\n    }\n  }, displayItems.length > 1 && React.createElement(React.Fragment, null, displayItems.map(function (el, index) {\n    return React.createElement(ListItem, {\n      key: index,\n      item: el,\n      removeItem: function removeItem() {\n        return _removeItem(index);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 20\n      }\n    });\n  })), displayItems.length < 1 && React.createElement(\"div\", {\n    className: \"resultList__fetching\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 9\n    }\n  }, React.createElement(\"i\", {\n    className: \"fas fa-utensils\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 11\n    }\n  }), React.createElement(\"h1\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 11\n    }\n  }, \"Fetching places...\")), displayItems.length === 1 && (displayItems[0].name === \"Error\" || displayItems[0].name === 500) && React.createElement(ErrorScreen, {\n    error: displayItems[0].name,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 9\n    }\n  }), displayItems.length === 1 && displayItems[0].name !== \"Error\" && displayItems[0].name !== \"Fetching\" && displayItems[0].name !== 500 && React.createElement(ChoiceView, {\n    item: displayItems[0],\n    toggleUi: toggleUi,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 9\n    }\n  }));\n};\n\nexport default resultList;","map":{"version":3,"sources":["/Users/Pablo/Documents/React/bitechoice/biteFinal/client/src/components/Results/ResultList.js"],"names":["React","useState","useEffect","ListItem","ChoiceView","lazy","ErrorScreen","getIndeces","businesses","indeces","length","push","number","Math","floor","random","includes","randomPicks","array","results","map","el","resultList","data","randomSorting","isCustom","toggleUi","customSearchTerms","name","categories","title","displayItems","setDisplayItems","setBusinesses","setStatesCustom","setStatesFromArray","inputData","searchTerms","setStatesFromTerms","newData","newDisplayItems","allResults","forEach","item","emptyArrays","every","j","shift","undefined","i","indexOf","splice","removeItem","passedIndex","filter","index","newState","newItem","newEntry","pickedArray"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\n\nimport './style.css';\nimport ListItem from '../ListItem';\nconst ChoiceView = React.lazy(() => import('../ChoiceView'));\nconst ErrorScreen = React.lazy(() => import('../ErrorScreen'));\n\n// TODO: result list\nfunction getIndeces(businesses) {\n  let indeces = [];\n  if (businesses.length <= 3) {\n    indeces.push(0, 2);\n  } else if (businesses.length !== 0) {\n    while (indeces.length < 3) {\n      let number = Math.floor(Math.random() * Math.floor(businesses.length));\n      if (!indeces.includes(number)) indeces.push(number);\n    };\n  }\n  return indeces;\n}\n\nfunction randomPicks(array) {\n  let results = getIndeces(array).map(el => {\n    return array[el];\n  })\n  return results;\n}\n\nconst resultList = ({ data, randomSorting, isCustom, toggleUi, customSearchTerms }) => {\n  const [displayItems, setDisplayItems] = useState([{ \n    name: 'Fetching', \n    categories: [{ title: '' }] \n  }]);\n  const [businesses, setBusinesses] = useState([]);\n\n  useEffect(() => {\n    if (isCustom) {\n      setStatesCustom(data);\n    } else {\n      setStatesFromArray(data);\n    }\n  }, [data, setBusinesses]);\n\n  const setStatesCustom = async (inputData) => {\n    let data = await inputData;\n    if (customSearchTerms.searchTerms.length === 0) {\n      setStatesFromArray(data);\n    } else if (customSearchTerms.searchTerms.length === 1) {\n      setStatesFromArray(data[0]);\n    } else {\n      setStatesFromTerms(data);\n    }\n  }\n\n  const setStatesFromTerms = async (inputData) => {\n    let newData = await inputData;\n    let newDisplayItems = [];\n    if (randomSorting) {\n      let allResults = [];   \n      newData.forEach(item => {\n        allResults = [...allResults, ...item];\n      });\n      setStatesFromArray(allResults);\n    } else {\n      while (newDisplayItems.length < 3) {\n        let emptyArrays = newData.every(item => item.length === 0);\n        if(emptyArrays) break;\n        for (let j=0; j<newData.length; j++) {\n          if(newData[j].length !== 0) {\n            newDisplayItems.push(newData[j].shift());\n          }\n          if(newDisplayItems.length === 3) break;\n        }\n      }\n      setBusinesses(newData);\n      setDisplayItems(newDisplayItems);\n    }\n  }\n \n  const setStatesFromArray = async (inputData) => {\n    let newData = await inputData;\n    let newDisplayItems = [];\n\n    if(newData === 500) {\n      newDisplayItems = [{ name: 500, categories: [{ title: '' }] }];\n    }\n\n    if (newData == \"error\" || newData === undefined) {\n      newDisplayItems = [{ name: \"Error\", categories: [{ title: '' }] }];\n    } else if (newData.length < 3 && newData.length !== 0) {\n      newDisplayItems = newData;\n    } else if (newData.length > 3) {\n      if (randomSorting) {\n        newDisplayItems = randomPicks(newData);\n      } else {\n        newDisplayItems = [newData[0], newData[1], newData[2]];\n      }\n      for (let i=0; i<newDisplayItems.length; i++) {\n        let item = newData.indexOf(newDisplayItems[i]);\n        if (item > -1) { newData.splice(item, 1) };\n      }\n    }\n    setBusinesses(newData);\n    setDisplayItems(newDisplayItems); \n  }\n\n  const removeItem = (passedIndex) => {\n    let newDisplayItems = displayItems.filter((el, index) => passedIndex !== index);\n    let newState = businesses;\n    let newItem;\n\n    if (randomSorting) {\n      newItem = newState[getIndeces(newState)[0]];\n      newState = newState.filter(el => newItem.name !== el.name);\n    } else {\n      if (customSearchTerms.searchTerms.length > 1) {\n        let newEntry = undefined;\n        while (newEntry === undefined) {\n          let emptyArrays = newState.every(item => item.length === 0);\n          if(emptyArrays) break;\n          let pickedArray = Math.floor(Math.random() * Math.floor(newState.length));\n          if (newState[pickedArray].length !== 0) { newEntry = newState[pickedArray].shift() }; \n        }\n        newItem = newEntry;\n      } else {\n        newItem = newState.shift();\n      }\n    }\n    if (newItem !== undefined) { newDisplayItems.push(newItem) };\n    setBusinesses(newState);\n    setDisplayItems(newDisplayItems);\n  }\n\n  return (\n    <div className={isCustom ? \"resultList resultList--custom\" : \"resultList\"}>\n      {displayItems.length > 1 && (\n        <>\n          {displayItems.map((el, index) => {\n            return <ListItem key={index} item={el} removeItem={() => removeItem(index)}/>\n          })}\n        </>\n      )}\n      {(displayItems.length < 1) && (\n        <div className=\"resultList__fetching\">\n          <i className=\"fas fa-utensils\" />\n          <h1>\n            Fetching places...\n          </h1>\n        </div>\n      )}\n      {(displayItems.length === 1 && (displayItems[0].name === \"Error\" || displayItems[0].name === 500)) && (\n        <ErrorScreen error={displayItems[0].name} />\n      )}      \n      {(displayItems.length === 1 && displayItems[0].name !== \"Error\" && displayItems[0].name !== \"Fetching\" && displayItems[0].name !== 500) && (\n        <ChoiceView item={displayItems[0]} toggleUi={toggleUi}/>\n      )} \n    </div>\n  );\n};\n\nexport default resultList;"]},"metadata":{},"sourceType":"module"}