{"ast":null,"code":"import _slicedToArray from \"/Users/Pablo/Documents/React/bitechoice/v4/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectSpread from \"/Users/Pablo/Documents/React/bitechoice/v4/client/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _regeneratorRuntime from \"/Users/Pablo/Documents/React/bitechoice/v4/client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/Pablo/Documents/React/bitechoice/v4/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nvar _jsxFileName = \"/Users/Pablo/Documents/React/bitechoice/v4/client/src/Store.js\";\nimport React, { useReducer, createContext } from \"react\";\nvar initialState = {\n  customView: {\n    resultsMode: false,\n    searchTerms: [],\n    sortBy: 'Best Match'\n  },\n  data: [],\n  ui: 'landing',\n  inputLocation: ''\n};\n\nvar randomSorting = function randomSorting() {\n  var criteria = ['best_match', 'rating', 'review_count', 'distance'];\n  return criteria[Math.floor(Math.random() * 4)];\n};\n\nvar searchTerm =\n/*#__PURE__*/\nfunction () {\n  var _ref = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(term, sort_by) {\n    var response, businesses;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return fetch('/search', {\n              method: 'POST',\n              headers: {\n                'Content-Type': 'application/json'\n              },\n              body: JSON.stringify({\n                term: term,\n                sort_by: sort_by\n              })\n            });\n\n          case 2:\n            response = _context.sent;\n            _context.next = 5;\n            return response.json();\n\n          case 5:\n            businesses = _context.sent;\n            return _context.abrupt(\"return\", businesses.businesses);\n\n          case 7:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function searchTerm(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar fetchData =\n/*#__PURE__*/\nfunction () {\n  var _ref2 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee2(searchInputs) {\n    var sortBy, searchTerms, sorting, data, termOne, termTwo, termThree, result, dataOne, dataTwo, dataThree;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            sortBy = searchInputs.sortBy, searchTerms = searchInputs.searchTerms;\n            sorting = sortBy === 'random' ? randomSorting() : sortBy;\n\n            if (!(searchTerms.length === 0)) {\n              _context2.next = 9;\n              break;\n            }\n\n            _context2.next = 5;\n            return searchTerm(null, sorting);\n\n          case 5:\n            data = _context2.sent;\n            return _context2.abrupt(\"return\", data);\n\n          case 9:\n            termOne = searchTerms[0] !== undefined ? searchTerms[0] : null;\n            termTwo = searchTerms[1] !== undefined ? searchTerms[1] : null;\n            termThree = searchTerms[2] !== undefined ? searchTerms[2] : null;\n            result = [];\n            dataOne = [];\n            dataTwo = [];\n            dataThree = [];\n\n            if (!(termOne !== null)) {\n              _context2.next = 20;\n              break;\n            }\n\n            _context2.next = 19;\n            return searchTerm(termOne, sorting);\n\n          case 19:\n            dataOne = _context2.sent;\n\n          case 20:\n            ;\n\n            if (!(termTwo !== null)) {\n              _context2.next = 25;\n              break;\n            }\n\n            _context2.next = 24;\n            return searchTerm(termTwo, sorting);\n\n          case 24:\n            dataTwo = _context2.sent;\n\n          case 25:\n            ;\n\n            if (!(termThree !== null)) {\n              _context2.next = 30;\n              break;\n            }\n\n            _context2.next = 29;\n            return searchTerm(termThree, sorting);\n\n          case 29:\n            dataThree = _context2.sent;\n\n          case 30:\n            ;\n\n            if (dataOne.length !== 0) {\n              result.push(dataOne);\n            }\n\n            ;\n\n            if (dataTwo.length !== 0) {\n              result.push(dataTwo);\n            }\n\n            ;\n\n            if (dataThree.length !== 0) {\n              result.push(dataThree);\n            }\n\n            ;\n            return _context2.abrupt(\"return\", result);\n\n          case 38:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function fetchData(_x3) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nvar fetchRandomData =\n/*#__PURE__*/\nfunction () {\n  var _ref3 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee3(newLocation, input) {\n    var response, businesses;\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.next = 2;\n            return fetch(\"/getRandom/\".concat(newLocation, \"/\").concat(input));\n\n          case 2:\n            response = _context3.sent;\n            _context3.next = 5;\n            return response.json();\n\n          case 5:\n            businesses = _context3.sent;\n            return _context3.abrupt(\"return\", businesses.businesses);\n\n          case 7:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n\n  return function fetchRandomData(_x4, _x5) {\n    return _ref3.apply(this, arguments);\n  };\n}(); // WORKING FETCH RANDOM DATA\n// const fetchRandomData = async () => {\n//   const response = await fetch('/getRandom');\n//   const businesses = await response.json();\n//   return businesses.businesses;\n// };\n\n\nfunction reducer(state, action) {\n  var customViewCopy = _objectSpread({}, state.customView);\n\n  switch (action.type) {\n    case 'TOGGLE_CUSTOM_FORM':\n      customViewCopy.resultsMode = !customViewCopy.resultsMode;\n      return _objectSpread({}, state, {\n        customView: customViewCopy\n      });\n\n    case 'SUBMIT_SEARCH':\n      customViewCopy = {\n        searchTerms: action.payload.searchTerms,\n        sortBy: action.payload.sortBy,\n        resultsMode: true\n      };\n      return _objectSpread({}, state, {\n        customView: customViewCopy,\n        data: fetchData(action.payload)\n      });\n\n    case 'FETCH_RANDOM_DATA':\n      //return { ...state, data: fetchRandomData() };\n      return _objectSpread({}, state, {\n        data: fetchRandomData(action.payload, state.inputLocation)\n      });\n\n    case 'TOGGLE_UI':\n      customViewCopy = {\n        resultsMode: false,\n        searchTerms: [],\n        sortBy: 'Best Match'\n      };\n      return _objectSpread({}, state, {\n        customView: customViewCopy,\n        data: [],\n        ui: action.payload\n      });\n\n    case 'UPDATE_LOCATION':\n      return _objectSpread({}, state, {\n        inputLocation: action.payload\n      });\n\n    default:\n      return state;\n  }\n}\n\n;\nexport function StoreProvider(props) {\n  var _useReducer = useReducer(reducer, initialState),\n      _useReducer2 = _slicedToArray(_useReducer, 2),\n      state = _useReducer2[0],\n      dispatch = _useReducer2[1];\n\n  var value = {\n    state: state,\n    dispatch: dispatch\n  };\n  return React.createElement(Store.Provider, {\n    value: value,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119\n    },\n    __self: this\n  }, props.children);\n}\nexport var Store = createContext();","map":{"version":3,"sources":["/Users/Pablo/Documents/React/bitechoice/v4/client/src/Store.js"],"names":["React","useReducer","createContext","initialState","customView","resultsMode","searchTerms","sortBy","data","ui","inputLocation","randomSorting","criteria","Math","floor","random","searchTerm","term","sort_by","fetch","method","headers","body","JSON","stringify","response","json","businesses","fetchData","searchInputs","sorting","length","termOne","undefined","termTwo","termThree","result","dataOne","dataTwo","dataThree","push","fetchRandomData","newLocation","input","reducer","state","action","customViewCopy","type","payload","StoreProvider","props","dispatch","value","children","Store"],"mappings":"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","sourcesContent":["import React, { useReducer, createContext } from \"react\";\n\nconst initialState = {\n  customView: {\n    resultsMode: false,\n    searchTerms: [],\n    sortBy: 'Best Match'\n  },\n  data: [],\n  ui: 'landing',\n  inputLocation: ''\n}\n\nconst randomSorting = () => {\n  const criteria = ['best_match', 'rating', 'review_count', 'distance'];\n  return criteria[Math.floor(Math.random() * 4)];\n};\n\nconst searchTerm = async (term, sort_by) => {\n  const response = await fetch('/search', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ \n      term,\n      sort_by\n    })\n  });\n  const businesses = await response.json();\n  return businesses.businesses;\n};\n\nconst fetchData = async (searchInputs) => {\n  const { sortBy, searchTerms } = searchInputs;\n  const sorting = sortBy === 'random' ? randomSorting() : sortBy\n\n  if (searchTerms.length === 0) {\n    const data = await searchTerm(null, sorting);\n\n    return data;\n  } else { \n    const termOne = searchTerms[0] !== undefined ? searchTerms[0] : null; \n    const termTwo = searchTerms[1] !== undefined ? searchTerms[1] : null; \n    const termThree = searchTerms[2] !== undefined ? searchTerms[2] : null; \n\n    let result = [];\n    let dataOne = [];\n    let dataTwo = [];\n    let dataThree = [];\n\n    if (termOne !== null) { dataOne = await searchTerm(termOne, sorting) };\n    if (termTwo !== null) { dataTwo = await searchTerm(termTwo, sorting) };\n    if (termThree !== null) { dataThree = await searchTerm(termThree, sorting) };\n\n    if (dataOne.length !== 0) { result.push(dataOne) };\n    if (dataTwo.length !== 0) { result.push(dataTwo) };\n    if (dataThree.length !== 0) { result.push(dataThree) };\n\n    return result;\n  }\n};\n\nconst fetchRandomData = async (newLocation, input) => {\n  const response = await fetch(`/getRandom/${newLocation}/${input}`);\n  const businesses = await response.json();\n  return businesses.businesses;\n};\n\n\n// WORKING FETCH RANDOM DATA\n// const fetchRandomData = async () => {\n//   const response = await fetch('/getRandom');\n//   const businesses = await response.json();\n//   return businesses.businesses;\n// };\n\n\n\n\n\nfunction reducer(state, action) {\n  let customViewCopy = { ...state.customView };\n\n  switch(action.type) {\n    case 'TOGGLE_CUSTOM_FORM':\n      customViewCopy.resultsMode = !customViewCopy.resultsMode;\n      return { ...state, customView: customViewCopy };\n\n    case 'SUBMIT_SEARCH':\n      customViewCopy = {\n        searchTerms: action.payload.searchTerms,\n        sortBy: action.payload.sortBy,\n        resultsMode: true\n      };\n      return { ...state, customView: customViewCopy, data: fetchData(action.payload) };\n\n    case 'FETCH_RANDOM_DATA':\n      //return { ...state, data: fetchRandomData() };\n      return { ...state, data: fetchRandomData(action.payload, state.inputLocation) }\n      \n    case 'TOGGLE_UI':\n      customViewCopy = {\n        resultsMode: false,\n        searchTerms: [],\n        sortBy: 'Best Match'\n      };\n      return { ...state, customView: customViewCopy, data: [], ui: action.payload };\n\n    case 'UPDATE_LOCATION':\n      return { ...state, inputLocation: action.payload }\n      \n    default:\n      return state;\n  }\n};\n\nexport function StoreProvider(props) {\n  const [state, dispatch] = useReducer(reducer, initialState)\n  const value = {state, dispatch}\n  return <Store.Provider value={value}>{props.children}</Store.Provider>\n}\n\nexport const Store = createContext();"]},"metadata":{},"sourceType":"module"}